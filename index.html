<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gandra - Saúde Integrativa</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonte Inter -->
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        /* Animação para o carregamento do app */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #root {
            animation: fadeIn 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Seção de Cabeçalho e Boas-vindas -->
    <header class="bg-white">
        <div class="container mx-auto px-6 py-12 text-center">
            <h1 class="text-4xl md:text-5xl font-bold text-emerald-800 tracking-tight">Gandra</h1>
            <p class="mt-2 text-lg text-emerald-700">Saúde Integrativa</p>
            <p class="mt-4 max-w-2xl mx-auto text-gray-600">
                Encontre o equilíbrio e renove suas energias.
            </p>
            <a href="#agendamento" class="mt-8 inline-block bg-emerald-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-emerald-700 transition-colors duration-300">
                Agendar Consulta
            </a>
        </div>
    </header>

    <!-- Seção Principal com o Aplicativo de Agendamento -->
    <main id="agendamento" class="py-16 md:py-24">
        <div class="container mx-auto px-4">
             <h2 class="text-3xl font-bold text-center text-emerald-800 mb-2">Marque sua consulta</h2>
             <p class="text-center text-gray-600 mb-12 max-w-xl mx-auto">Siga os passos abaixo para agendar seu atendimento de forma rápida e segura.</p>
            <!-- O aplicativo React será renderizado aqui -->
            <div id="root">
                <div class="text-center text-gray-500 p-8">
                    <p>Carregando sistema de agendamento...</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Seção do Rodapé -->
    <footer class="text-center p-8 bg-white mt-16">
        <p class="text-gray-500 text-sm">&copy; 2025 Higor Gandra - Todos os direitos reservados.</p>
        <p class="text-gray-400 text-xs mt-1">Salvador, Bahia, Brasil</p>
    </footer>


    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel (para transpilar JSX no navegador) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Script do Aplicativo React (integrado) -->
    <script type="text/babel">
        const { useState, useMemo } = React;

        // --- ÍCONES (substitutos para lucide-react para serem independentes) ---
        const UserIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
            <circle cx="12" cy="7" r="4" />
          </svg>
        );

        const CloseIcon = ({ className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="18" y1="6" x2="6" y2="18" />
                <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
        );

        // --- DADOS MOCK (Simulação de dados reais) ---
        const services = [
          { id: 1, name: 'Sessão de Acupuntura', duration: 60, price: 'R$ 180' },
          { id: 2, name: 'Consulta Integrativa', duration: 90, price: 'R$ 250' },
          { id: 3, name: 'Ventosaterapia', duration: 45, price: 'R$ 120' },
          { id: 4, name: 'Auriculoterapia', duration: 30, price: 'R$ 90' },
        ];

        const availableTimes = ['09:00', '10:00', '11:00', '14:00', '15:00', '16:00', '17:00'];

        // --- COMPONENTE PRINCIPAL ---
        function App() {
          const [step, setStep] = useState(1);
          const [selectedService, setSelectedService] = useState(null);
          const [selectedDate, setSelectedDate] = useState(new Date());
          const [selectedTime, setSelectedTime] = useState('');
          const [userInfo, setUserInfo] = useState({ name: '', email: '', phone: '' });
          const [isModalOpen, setIsModalOpen] = useState(false);
          const [isLoading, setIsLoading] = useState(false);
          
          const [bookedAppointments, setBookedAppointments] = useState([]);

          const handleBack = () => {
              if (step > 1) {
                  setStep(step - 1);
              }
          };

          const handleServiceSelect = (service) => {
            setSelectedService(service);
            setStep(2);
          };

          const handleDateSelect = (date) => {
            setSelectedDate(date);
            setSelectedTime('');
          };
          
          const handleTimeSelect = (time) => {
            setSelectedTime(time);
            setStep(3);
          };

          const handleUserInfoChange = (e) => {
            const { name, value } = e.target;
            setUserInfo(prev => ({ ...prev, [name]: value }));
          };

          const handleBookingSubmit = (e) => {
            e.preventDefault();
            if (userInfo.name && userInfo.email && userInfo.phone) {
                setIsLoading(true);
                setTimeout(() => {
                    const newAppointment = {
                        serviceId: selectedService.id,
                        date: selectedDate.toISOString().split('T')[0],
                        time: selectedTime
                    };
                    setBookedAppointments(prev => [...prev, newAppointment]);
                    setIsLoading(false);
                    setIsModalOpen(true);
                }, 1500);
            }
          };
          
          const resetFlow = () => {
              setStep(1);
              setSelectedService(null);
              setSelectedDate(new Date());
              setSelectedTime('');
              setUserInfo({ name: '', email: '', phone: '' });
              setIsModalOpen(false);
          }

          return (
            <div className="w-full max-w-4xl bg-white rounded-2xl shadow-lg flex flex-col md:flex-row overflow-hidden mx-auto">
              
              <div className="w-full md:w-1/3 bg-emerald-700 text-white p-8 flex flex-col">
                <h1 className="font-bold text-3xl mb-2">Gandra</h1>
                <p className="text-emerald-200 text-sm mb-8">Saúde Integrativa</p>
                
                <div className="space-y-6 mt-auto">
                    <StepInfo num={1} text="Escolha o Serviço" active={step === 1} done={step > 1} />
                    <StepInfo num={2} text="Selecione a Data e Hora" active={step === 2} done={step > 2} />
                    <StepInfo num={3} text="Seus Dados Pessoais" active={step === 3} done={step > 3} />
                </div>

                {selectedService && step > 1 && (
                  <div className="mt-10 p-4 bg-emerald-800 rounded-lg text-sm">
                      <h3 className="font-semibold mb-2">Resumo do Agendamento:</h3>
                      <p className="text-emerald-200"><strong>Serviço:</strong> {selectedService.name}</p>
                      {selectedTime && <p className="text-emerald-200"><strong>Data:</strong> {selectedDate.toLocaleDateString('pt-BR')} às {selectedTime}</p>}
                  </div>
                )}
              </div>

              <div className="w-full md:w-2/3 p-8 md:p-12">
                {step === 1 && <ServiceSelector services={services} onSelect={handleServiceSelect} />}
                {step === 2 && <DateTimePicker onBack={handleBack} selectedDate={selectedDate} onDateSelect={handleDateSelect} onTimeSelect={handleTimeSelect} availableTimes={availableTimes} selectedTime={selectedTime} bookedAppointments={bookedAppointments} selectedService={selectedService} />}
                {step === 3 && <UserInfoForm onBack={handleBack} userInfo={userInfo} onChange={handleUserInfoChange} onSubmit={handleBookingSubmit} isLoading={isLoading} />}
              </div>

              {isModalOpen && <ConfirmationModal service={selectedService} date={selectedDate} time={selectedTime} user={userInfo} onClose={resetFlow} />}
            </div>
          );
        }

        // --- SUB-COMPONENTES ---

        const StepInfo = ({ num, text, active, done }) => (
            <div className="flex items-center">
                <div className={`w-8 h-8 rounded-full flex items-center justify-center mr-4 font-bold text-lg ${
                    active ? 'bg-white text-emerald-700' : 
                    done ? 'bg-emerald-500 text-white' : 'border-2 border-emerald-400 text-emerald-300'
                }`}>
                    {done ? '✓' : num}
                </div>
                <span className={`${active ? 'font-bold text-white' : 'text-emerald-200'}`}>{text}</span>
            </div>
        );

        const ServiceSelector = ({ services, onSelect }) => (
          <div>
            <h2 className="text-2xl font-bold text-gray-800 mb-6">Escolha um serviço</h2>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
              {services.map(service => (
                <button key={service.id} onClick={() => onSelect(service)} className="text-left p-4 border rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-emerald-500 border-gray-200 hover:border-emerald-500 hover:bg-emerald-50">
                  <p className="font-semibold text-gray-700">{service.name}</p>
                  <p className="text-sm text-gray-500">{service.duration} min - {service.price}</p>
                </button>
              ))}
            </div>
          </div>
        );

        const DateTimePicker = ({ selectedDate, onDateSelect, onTimeSelect, availableTimes, selectedTime, onBack, bookedAppointments, selectedService }) => {
          const today = new Date();
          const startOfToday = new Date();
          startOfToday.setHours(0, 0, 0, 0);
          
          const handleDayClick = (day) => {
            const newDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), day);
            onDateSelect(newDate);
          }

          const calendarDays = useMemo(() => {
            const year = selectedDate.getFullYear();
            const month = selectedDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            let days = [];
            for(let i=0; i < firstDay; i++) days.push(null);
            for(let i=1; i <= daysInMonth; i++) days.push(i);
            
            return days;
          }, [selectedDate]);

          const monthName = selectedDate.toLocaleString('pt-BR', { month: 'long' });
          const year = selectedDate.getFullYear();

          const changeMonth = (offset) => {
              const newDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth() + offset, 1);
              onDateSelect(newDate);
          }

          const selectedDateString = selectedDate.toISOString().split('T')[0];
          const bookedTimesForDay = bookedAppointments
              .filter(booking => booking.date === selectedDateString && booking.serviceId === selectedService.id)
              .map(booking => booking.time);

          return (
            <div>
              <div className="flex items-center justify-between mb-6">
                <h2 className="text-2xl font-bold text-gray-800">Selecione a data e hora</h2>
                <button onClick={onBack} className="text-sm font-medium text-gray-500 hover:text-gray-900 transition-colors flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className="mr-1"><path d="m15 18-6-6 6-6"/></svg>
                    Voltar
                </button>
              </div>
              <div className="bg-gray-50 p-4 rounded-lg">
                <div className="flex items-center justify-between mb-4">
                    <button onClick={() => changeMonth(-1)} className="p-2 rounded-full hover:bg-gray-200">&lt;</button>
                    <h3 className="font-semibold text-lg capitalize">{monthName} de {year}</h3>
                    <button onClick={() => changeMonth(1)} className="p-2 rounded-full hover:bg-gray-200">&gt;</button>
                </div>
                <div className="grid grid-cols-7 gap-2 text-center text-sm">
                    {['D', 'S', 'T', 'Q', 'Q', 'S', 'S'].map((d, index) => <div key={`${d}-${index}`} className="font-bold text-gray-500">{d}</div>)}
                    {calendarDays.map((day, index) => {
                        const currentDate = day ? new Date(selectedDate.getFullYear(), selectedDate.getMonth(), day) : null;
                        const isPast = currentDate && currentDate < startOfToday;
                        const isToday = day === today.getDate() && selectedDate.getMonth() === today.getMonth() && selectedDate.getFullYear() === today.getFullYear();
                        const isSelected = day === selectedDate.getDate();
                        return (
                            <div key={index}>
                              {day && (
                                <button 
                                    onClick={() => !isPast && handleDayClick(day)}
                                    disabled={isPast}
                                    className={`w-10 h-10 rounded-full transition-colors ${
                                        isPast ? 'text-gray-300 cursor-not-allowed' :
                                        isSelected ? 'bg-emerald-600 text-white' :
                                        isToday ? 'bg-emerald-200 text-emerald-800' :
                                        'hover:bg-gray-200'
                                    }`}
                                >{day}</button>
                              )}
                            </div>
                        )
                    })}
                </div>
              </div>
              
              <div className="mt-6">
                <h3 className="font-semibold text-gray-700 mb-4">Horários disponíveis</h3>
                <div className="grid grid-cols-3 sm:grid-cols-4 gap-3">
                  {availableTimes.map(time => {
                    const isBooked = bookedTimesForDay.includes(time);
                    return (
                        <button 
                          key={time} 
                          onClick={() => !isBooked && onTimeSelect(time)}
                          disabled={isBooked}
                          className={`p-3 rounded-lg text-sm font-medium transition-colors ${
                              isBooked
                                  ? 'bg-gray-200 text-gray-500 cursor-not-allowed line-through'
                                  : selectedTime === time 
                                      ? 'bg-emerald-600 text-white shadow-md' 
                                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                          }`}
                        >{time}</button>
                    );
                  })}
                </div>
              </div>
            </div>
          );
        };

        const UserInfoForm = ({ userInfo, onChange, onSubmit, isLoading, onBack }) => (
          <div>
            <div className="flex items-center justify-between mb-6">
                <h2 className="text-2xl font-bold text-gray-800 flex items-center">
                    <UserIcon className="w-7 h-7 mr-3 text-emerald-600"/>
                    Informações Pessoais
                </h2>
                <button onClick={onBack} className="text-sm font-medium text-gray-500 hover:text-gray-900 transition-colors flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className="mr-1"><path d="m15 18-6-6 6-6"/></svg>
                    Voltar
                </button>
            </div>
            <p className="text-gray-600 mb-8">Por favor, preencha seus dados para confirmarmos o agendamento.</p>
            <form onSubmit={onSubmit} className="space-y-6">
              <div>
                <label htmlFor="name" className="block text-sm font-medium text-gray-700 mb-1">Nome Completo</label>
                <input type="text" id="name" name="name" value={userInfo.name} onChange={onChange} required className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500" placeholder="Seu nome"/>
              </div>
              <div>
                <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">E-mail</label>
                <input type="email" id="email" name="email" value={userInfo.email} onChange={onChange} required className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500" placeholder="seu@email.com"/>
              </div>
              <div>
                <label htmlFor="phone" className="block text-sm font-medium text-gray-700 mb-1">Telefone / WhatsApp</label>
                <input type="tel" id="phone" name="phone" value={userInfo.phone} onChange={onChange} required className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500" placeholder="(XX) XXXXX-XXXX"/>
              </div>
              <button 
                type="submit" 
                disabled={isLoading}
                className="w-full bg-emerald-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-emerald-700 transition-all duration-300 flex items-center justify-center disabled:bg-emerald-400 disabled:cursor-not-allowed">
                {isLoading ? (
                    <>
                        <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle><path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        Agendando...
                    </>
                ) : 'Confirmar Agendamento'}
              </button>
            </form>
          </div>
        );


        const ConfirmationModal = ({ service, date, time, user, onClose }) => {
            const whatsappMessage = encodeURIComponent(`Olá! Gostaria de confirmar meu agendamento para "${service.name}" (Valor: ${service.price}) no dia ${date.toLocaleDateString('pt-BR')} às ${time}. Meu nome é: ${user.name}.`);
            // Lembre-se de substituir "55XXYYYYYYYYY" pelo número de WhatsApp da clínica
            const whatsappUrl = `https://wa.me/55XXYYYYYYYYY?text=${whatsappMessage}`;

            return (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div className="bg-white rounded-2xl shadow-xl max-w-md w-full p-8 text-center relative transform transition-all animate-fade-in-up">
                    <button onClick={onClose} className="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                        <CloseIcon className="w-6 h-6" />
                    </button>
                    <div className="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-emerald-100 mb-4">
                        <svg className="h-10 w-10 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" /></svg>
                    </div>
                    <h3 className="text-2xl font-bold text-gray-900">Agendamento Quase Concluído!</h3>
                    <p className="text-gray-600 mt-2 mb-6">Sua consulta foi pré-agendada. Por favor, confirme no WhatsApp para finalizar e garantir seu horário.</p>
                    <div className="text-left bg-gray-50 p-4 rounded-lg space-y-2 text-sm mb-6">
                        <p><strong>Paciente:</strong> {user.name}</p>
                        <p><strong>Serviço:</strong> {service.name}</p>
                        <p><strong>Valor:</strong> {service.price}</p>
                        <p><strong>Data:</strong> {date.toLocaleDateString('pt-BR')} às {time}</p>
                    </div>
                    
                    <a 
                      href={whatsappUrl}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="w-full block bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-all duration-300 flex items-center justify-center gap-2"
                    >
                        <span>Confirmar no WhatsApp</span>
                    </a>
                    
                    <button onClick={onClose} className="mt-4 w-full bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors">
                        Fechar
                    </button>
                </div>
            </div>
            );
        };

        // Renderiza o aplicativo no DOM
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

